---
layout: post
title:  "21년 5월 4일 - AWS 네트워크 설정"
excerpt: ""

categories:
  - TIL
tags:
  - [AWS, Network]

toc: true
toc_sticky: true
comments: true
 
date: 2021-05-04
last_modified_at: 2021-05-04

---

## 한 일

- AWS 및 네트워크

  - VPC

    - 사용자의 AWS 계정 전용 사설 네트워크 망
    - 리전 하나를 선택하여 만들 수 있다.

  - CIDR

    - 가용한 IP 주소 범위를 나타내는 표기법
    - 0.0.0.0/0 이라면 0.0.0.0~255.255.255.255의 모든 IP를 사용하겠다는 의미
    - 10.1.0.0/16 이라면 10.1.0.0 ~ 10.1.255.255 의 IP를 사용하겠다는 의미
    - /(숫자) 에서 숫자는 왼쪽부터 (숫자)비트 만큼의 IP를 고정하겠다는 의미이다.

  - 서브넷

    - VPC내의 부분 망을 또 나누는 것

    - 예를 들어, private 또는 public 망으로 나누고 싶을 때 사용

      (private에는 private용 라우터 연결, public에는 public용 라우터 연결)

    - 일반적으로 웹서버는 public 망에, DB서버는 private 망에 둔다.

  - 라우터

    - L3까지 (네트워크 계층 즉 IP주소) 알고 있음
    - 어떤 IP를 어디로 보낼지 목적지를 정할 수 있음
    - public에 개방하고 싶은 라우터는 any address를 internet gateway에 연결
    - private으로 외부에서 접속은 불가능하지만, 외부 인터넷을 사용하고 싶을 때에는 any address를 NAT에 연결

  - 인터넷 게이트웨이

    - 그냥 인터넷과 사설망을 연결해주는 양방향 문이라고 할 수 있음

  - NAT
    - 인터넷 리스폰스를 받을 수 있도록, 사설 IP를 공인 IP로 바꿔줌
    - 사설 IP -> NAT -> 인터넷 게이트웨이 -> 인터넷
    - 인터넷 -> 인터넷 게이트웨이 -> NAT -> 사설IP로는 접근 불가 (리스폰스는 예외)
  - DB 인스턴스에 mysql 설치하려면 ssh 접속해야함
    - 웹서버 로 ssh접속하고 거기서 DB 인스턴스로 ssh 접속 해야 하는데, 웹서버에 DB인스턴스 키 파일 놓는다?
      - 보물창고 앞에 보물창고 키 놓는 격
    - ``ssh-add -K key파일.pem`` ssh key forwarding하여 접근하면 된다.
  - NAT 게이트웨이
    - AWS에서 제공해주는 것
    - NAT가 SPOF 나지 않도록 트래픽이 증가하면 NAT를 늘려주고 등등 편한 서비스
    - 가격이 비싸다
  - NAT 사용하지 않고 임시로 DB 인스턴스에서 인터넷 사용하기 (돈 안들이기)
    - mysql 설치 등 인터넷이 필요할 때만, 라우팅 테이블을 igw와 연결된 라우팅 테이블로 바꾼다.
    - 일라스틱 ip로 db 인스턴스에 탄력적 ip주소를 붙여준다.
    - 인터넷 사용이 끝나면 라우팅 테이블을 private용으로 바꾸고, db인스턴스에 탄력적 ip주소를 뗀다.

## 느낌

- 

## 할 일

- 코드스쿼드 미션하기
- 프로그래머스 문제 풀기
- 면접 준비

